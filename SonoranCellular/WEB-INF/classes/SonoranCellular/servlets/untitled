WITH SQ AS (SELECT * FROM ITEM NATURAL JOIN ISASSOCIATEDWITH WHERE ACCOUNTNUMBER = 100 ORDER BY  ITEMNUMBER) SELECT TO_CHAR( ROUND(SQ.ENDDATE,'MONTH') - INTERVAL '1' MONTH, 'MON-YYYY'), ITEMNUMBER, SUBSCRIBE.ACCOUNTNUMBER, NAME, MOBILENUMBER, SQ.PLANNAME, ACTUALDATAUSAGE, Plan.AllowedDataUsage FROM SQ JOIN SUBSCRIBE ON SQ.IMEI = SUBSCRIBE.IMEI JOIN PHONE ON SQ.IMEI = PHONE.IMEI JOIN ACCOUNT ON SUBSCRIBE.ACCOUNTNUMBER = ACCOUNT.ACCOUNTNUMBER JOIN PLAN on Plan.PlanName =SQ.PlanName ORDER BY SQ.ENDDATE,ITEMNUMBER